<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jspBoard.board.dao">

<!-- 게시판 카테고리 리스트 -->
<select id="getBoardPagingList" resultType="boardVo" parameterType="boardVo" >
	select a.*
	 from 
	    (select a.*, rownum rn
	     from 
	        (select board.*, level lv
	         from board
	        start with categoryNo = #{categoryNo} and pboardno=0
	        connect by prior boardno = pboardno and categoryNo = #{categoryNo}
	        order siblings by ord, boardNo desc ) a ) a
	where rn between (#{page}-1)*#{pageSize} +1 and (#{page}*#{pageSize}) 
</select>

<!-- 게시물 전체 건수 조회 -->
<select id="getBoardTotalCnt" resultType="Integer" parameterType="boardVo">
	select count(*) cnt
	 from board
	where categoryNo = #{categoryNo}
</select>

<!-- 게시물 상세 조회 -->
<select id="getBoardDetail" resultType="boardVo" parameterType="boardVo">
	select *
	 from board
	where boardNo = #{boardNo}
</select>

<!-- 게시물 수정 -->
<update id="modifyBoard" parameterType="boardVo">
	update board set title = #{title}, content = #{content}, regDt = sysdate
	where boardNo = #{boardNo}
</update>

<!-- 게시물 삭제 -->
<update id="deleteBoard" parameterType="boardVo">
	update board set delYn = 'Y', regDt = sysdate
	where boardNo = #{boardNo}
</update>
</mapper> 